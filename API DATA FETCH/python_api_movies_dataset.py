# -*- coding: utf-8 -*-
"""python-api-movies_dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1rILwJf_KT3KAfQNMoBoKOb0zqDCE-hmo
"""



import requests
import pandas as pd

url = "https://api.themoviedb.org/3/movie/top_rated?api_key=<<Your api key>>&language=en-US&page=1"

requests.get(url)

response = requests.get(url)

response.json()["results"]

df = pd.DataFrame(response.json()["results"])

movies = df[["id","title","overview","release_date","vote_average","vote_count"]]

movies

data = pd.DataFrame()
data

list = []
for i in range(1,494):
  response = requests.get(f"https://api.themoviedb.org/3/movie/top_rated?api_key=<<Your api key>>&language=en-US&page={i}")
  temp  = pd.DataFrame(response.json()["results"])
  list.append(temp)

new = list[0] + list[1]

list[0].shape

new.shape

data = pd.concat(list, ignore_index=True)

movies_data = data[["id","title","overview","release_date","genre_ids","popularity","vote_average","vote_count"]]

movies_data.tail()

movies_data.shape

movies_data.info()

movies_data.to_csv("movies.csv")

